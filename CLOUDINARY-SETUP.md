# Cloudinary Setup Guide

## Quick Setup Steps

### 1. Create Cloudinary Account
1. Go to [cloudinary.com](https://cloudinary.com)
2. Click "Sign Up For Free"
3. Fill out the registration form
4. Verify your email
5. Log in to your dashboard

### 2. Get Your Credentials
From your Cloudinary dashboard, copy these values:
- **Cloud Name** (found in Dashboard > Account Details)
- **API Key** (found in Dashboard > Account Details)
- **API Secret** (found in Dashboard > Account Details)

### 3. Configure Environment Variables
Create or update your `.env.local` file:

```env
# Image Storage Configuration
STORAGE_TYPE="cloudinary"

# Cloudinary Credentials
CLOUDINARY_CLOUD_NAME="your-cloud-name-here"
CLOUDINARY_API_KEY="your-api-key-here"
CLOUDINARY_API_SECRET="your-api-secret-here"
CLOUDINARY_UPLOAD_PRESET="ola-y-lagona-preset"
```

### 4. Install Dependencies
```bash
npm install
```

### 5. Create Upload Preset
```bash
npm run cloudinary:setup
```

This will create an unsigned upload preset with:
- Automatic image optimization
- Multiple image sizes (400x400, 800x800, 1200x1200)
- WebP format conversion
- Organized folder structure

### 6. Migrate Existing Images (Optional)
If you have existing images in `public/uploads/`:

```bash
npm run images:migrate
```

This will:
- Upload all existing images to Cloudinary
- Generate SQL update statements
- Save migration results to `migration-results.json`

### 7. Update Database (If Migrating)
Run the SQL statements generated by the migration script to update your database with Cloudinary URLs.

### 8. Test Upload Functionality
1. Start your development server: `npm run dev`
2. Go to admin panel: `http://localhost:3000/admin/gallery`
3. Try uploading a new image
4. Verify the image appears with a Cloudinary URL

## Cloudinary Features You Get

### Automatic Optimization
- **Format optimization:** WebP, AVIF for supported browsers
- **Quality optimization:** Automatic quality adjustment
- **Size optimization:** Multiple sizes for different devices

### CDN Delivery
- **Global edge locations:** Fast loading worldwide
- **Automatic caching:** Reduced bandwidth usage
- **HTTPS delivery:** Secure image serving

### Image Transformations
- **Responsive images:** Automatic sizing
- **Lazy loading:** Built-in lazy loading support
- **Progressive loading:** Better user experience

## Example URLs

After setup, your images will have URLs like:
```
https://res.cloudinary.com/your-cloud/image/upload/v1234567890/ola-y-lagona/filename.jpg
```

With automatic optimization:
```
https://res.cloudinary.com/your-cloud/image/upload/f_auto,q_auto,w_800/v1234567890/ola-y-lagona/filename.jpg
```

## Troubleshooting

### Common Issues

1. **"Invalid cloud name" error:**
   - Check your `CLOUDINARY_CLOUD_NAME` in `.env.local`
   - Ensure no extra spaces or quotes

2. **"Invalid API key" error:**
   - Verify your `CLOUDINARY_API_KEY` and `CLOUDINARY_API_SECRET`
   - Check for typos in credentials

3. **Upload preset not found:**
   - Run `npm run cloudinary:setup` to create the preset
   - Or create it manually in Cloudinary dashboard

4. **Images not displaying:**
   - Check browser console for errors
   - Verify CORS settings in Cloudinary
   - Ensure HTTPS is enabled

### Getting Help

1. **Cloudinary Documentation:** [cloudinary.com/docs](https://cloudinary.com/docs)
2. **Free Tier Limits:** 25GB storage, 25GB bandwidth/month
3. **Support:** Available through Cloudinary dashboard

## Next Steps

1. **Test thoroughly** with different image types and sizes
2. **Monitor usage** in Cloudinary dashboard
3. **Set up monitoring** for upload failures
4. **Consider upgrading** if you exceed free tier limits

## Security Notes

- **Never commit** `.env.local` to version control
- **Use environment variables** for all credentials
- **Enable HTTPS** for production
- **Set up proper CORS** if needed
- **Monitor upload activity** for suspicious behavior
